%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%% 1 - Preparação do código %% %% Boas práticas: limpeza de variáveis; variáveis globais%% Constantes; carregar bibliotecas;...%%clear all;          % limpa as variáveisclose all;          % fecha todas as figuras ativasclc;                % limpa a tela visível%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%% 2 - Investigação do sinal g(t) %% %% %% g(t) = 1 - exp(-t) --> 0 < t < To%%%% To =1.0 segundo%%To      = 1.0;                    % Período do sinalM       = 1000;                   % Número de pontos - resolução 1msNp      = 2;                      % Número de períodostempo1  = linspace(0,Np*To,Np*M); % vetor tempo para dois períodostempo   = linspace(0,To,M);       % vetor tempo%%% trabalhar com o sinalgt = @(t) 1-exp(-t);            % criei a função gt%%% Visualizar o sinal g(t)figure(1)plot(tempo,gt(tempo),'linewidth',3);grid;xlabel('Tempo em segundos');ylabel('Amplitude em volts');title('Sinal sob investigacao');figure(2)plot(tempo1,[gt(tempo) gt(tempo)],'linewidth',3);grid;xlabel('Tempo em segundos');ylabel('Amplitude em volts');title('Sinal sob investigacao - 2 períodos');%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%% 3 - Investigação da série de Fourier - Dn%% %% %% Dn = exp(-jnpi) * sin(npi)/(npi) - ...%%%% ... (1 - exp(-(1+jn2pi)))/(1+jn2pi)%%%%  -- sinc (X) - Compute the sinc function.%%     Return sin (pi*x) / (pi*x).%%Dn = @(n) exp(-j*n*pi).*sinc(n) - (1 - exp(-(1+j*n*2*pi)))./(1+j*n*2*pi);%%% Definir a variável nN    = 100;               % analisar 21 harmônicas - 2*N+1 (1: zero)n    = [-N:1:N];         % harmônicasfo   = 1/To;             % frequência fundamentalwo   = 2*pi*fo;          % frequência angular fundamentalfreq = n*fo;             % frequências de FourierSF   = Dn(n);            % coeficients da série de Fourierfigure(3)stem(freq,abs(SF),'linewidth',3);grid;xlabel('Frequência em Hz');ylabel('Amplitude em volts');title('Sinal sob investigacao - na frequencia');figure(4)stem(freq,angle(SF)*180/pi,'linewidth',3);grid;xlabel('Frequência em Hz');ylabel('Fase em graus');title('Sinal sob investigacao - na frequencia');%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%% 4 - Sintese do sinal g(t) a partir do Dn%% %% %% Dn = exp(-jnpi) * sin(npi)/(npi) - ...%%%% ... (1 - exp(-(1+jn2pi)))/(1+jn2pi)%%%% gs(t) = sum_{-N}^{N} Dn exp(jnwot)gs  = 0;     % valor incial do sinal sintetizadogs1 = 0;     % valor incial do sinal sintetizadofor k = 1 : 2*N+1  gs  = gs  + SF(k)*exp(j*n(k)*wo*tempo);   gs1 = gs1 + SF(k)*exp(j*n(k)*wo*tempo1); end  figure(5)plot(tempo,gt(tempo),'linewidth',3,'g--');grid; hold;plot(tempo,gs,'linewidth',3,'b-.');xlabel('Tempo em segundos');ylabel('Amplitude em volts');title('Sinal sob investigacao');figure(6)plot(tempo1,[gt(tempo) gt(tempo)],'linewidth',3,'g--');grid;hold;plot(tempo1,gs1,'linewidth',3,'b-.');xlabel('Tempo em segundos');ylabel('Amplitude em volts');title('Sinal sob investigacao - 2 períodos');%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%% 5 - Visualizando energia%% %% %%  abs(Dn) ^ 2figure(7)stem(freq,abs(SF).^2,'linewidth',3);grid;xlabel('Frequência em Hz');ylabel('Amplitude em volts');title('Sinal sob investigacao - na frequencia');